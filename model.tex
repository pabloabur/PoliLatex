\chapter{Modelo neuromusculoesquelético utilizado}
\label{cap:model}

\index{modelo realista}

\index{modelo!neuromusculoesquelético}
O modelo neuromusculoesquelético utilizado~\cite{Cisi2008, Elias2012, Watanabe2013, Elias2013, Elias2014, Watanabe2015} representa o \acf{TA} (músculo da perna responsável pela flexão dorsal) e os três músculos do \acf{TS}: \ac{SOL}, \ac{GM} e \ac{GL} (músculos da perna responsáveis pela flexão plantar), juntamente com os seus respectivos núcleos de unidades motoras e proprioceptores.

Na Figura~\ref{fig:generalstruct} está um diagrama simplificado com a visão geral do modelo neuromusculoesquelético utilizado ao longo deste trabalho. 

\begin{figure}[h!]
	\center
	\includegraphics[scale=0.7]{modelStruct.eps}
	\caption[Visão geral do modelo neuromusculoesquelético biologicamente realista]{Visão geral do modelo neuromusculoesquelético biologicamente realista utilizado ao longo deste trabalho. $\act(t)$: sinal de ativação muscular; $\F(t)$: força gerada pelo músculo; $\angvar(t)$: ângulo de variação do tornozelo; $\Lm^M(t)$:comprimento muscular; $\vm(t)$: velocidade de variação do comprimento muscular; $\Lm^{MT}(t)$: comprimento do sistema musculotendíneo.}
	\label{fig:generalstruct}
\end{figure}

Cada um dos músculos que compõe o modelo da Figura~\ref{fig:generalstruct} é modelado separadamente. Desta forma, cada um dos músculos tem os sinais $\act(t)$, $\F(t)$, $\Lm^M(t)$, $\vm(t)$ e $\Lm^{MT}(t)$ calculados de forma independente dos outros músculos. 

Nas seções a seguir, cada um dos blocos da Figura~\ref{fig:generalstruct} é explicado de forma detalhada.

\section{Modelo do núcleo de unidades motoras}
\label{sec:pool}

\index{modelo!núcleo de unidades motoras}
O modelo do núcleo de unidades motoras usado foi descrito em~\cite{Cisi2008, Elias2012, Watanabe2013,Elias2014}. Na Figura~\ref{fig:poolstruct} está um diagrama da estrutura do modelo do núcleo de unidades motoras. 


\begin{figure}[ht!]
	\center
	\includegraphics[scale=0.7]{poolStruct_PTTSTA.eps}
	\caption[Estrutura do modelo de núcleo de unidades motoras]{Estrutura do núcleo de unidades motoras usado nesse estudo (a) visão esquemática do tibial anterior (TA). O núcleo de unidades motoras do TA consiste em seus motoneurônios (MNs) e suas respectivas unidades musculares (UM). $\act_{\text{TA}}$: sinal de ativação do TA; (b) visão esquemática do tríceps sural (TS) e seus três músculos: Sóleo (SOL), Gastrocnêmio Medial (GM) e Gastrocnêmio Lateral (GL). O núcleo de unidades motoras de cada músculo do TS consiste em seus MNs e suas respectivas UMs. $\act_{\text{SOL}}, \act_{\text{GM}}, \act_{\text{GL}}$: sinal de ativação do SOL, GM e GL, respectivamente; (c) representação esquemática das unidades motoras (MNs e UMs) de um músculo. Cada um dos N processos pontuais de renovação representando os axônios descendentes e provindos dos diferentes proprioceptores (reflexos) se conecta a uma fração dos MNs. Cada UM recebe um trem de potenciais de ação (PAs) do seu MN. Esse trem de PAs é filtrado por um sistema de segunda-ordem criticamente amortecido. Cada um desses sinais filtrados é somado para produzir o sinal de ativação $a$; (d)  trem de 
processos pontuais de renovação representando um trem de PAs de um axônio; (e) circuito usado para representar o modelo de MN; $g_{syn_1}$ a $g_{syn_M}$:condutância sináptica para sinapse 1 a $M$; $g_c$: condutância de acoplamento; $g_{Ld}$ e $g_{Ls}$: condutância de fuga dendrítica e do soma, respectivamente; $g_{Na}$, $g_{Kf}$ e $g_{Ks}$: condutâncias de $\text{Na}^+$, $\text{K}^+$ rápido e $\text{K}^+$ lento, respectivamente; $E_L$: potencial de Nernst; $E_{Na}$ e $E_K$: potencial de equilíbrio de $\text{Na}^+$ e $\text{K}^+$, respectivamente; $E_{syn_1}$ a $E_{syn_M}$: potencial de reversão das sinapses 1 a $M$; $C_s$ e $C_D$: capacitâncias somáticas e dendríticas, respectivamente; $V_S$ e $V_D$: potencial de membrana do soma e do dendrito, respectivamente; (f) uma parcela do sinal de ativação produzida por uma UM; (g) função de saturação de uma UM.}
	\label{fig:poolstruct}
\end{figure}

\index{modelo!motoneurônio}
Os  \acfp{MN}  foram representados por modelos do tipo {\it conductance-based} com dois compartimentos, um representando o soma e outro a arborização dendrítica do \ac{MN}. O circuito elétrico que representa o comportamento de um \ac{MN} está na Figura~\ref{fig:poolstruct}(e). A solução das equações diferenciais de Hodgkin-Huxley dos canais iônicos~\cite{Hodgkin1952a} são aproximadas por pulsos~\cite{Destexhe1997}. Os parâmetros dos \acp{MN} são distribuídos linearmente de forma que o princípio do tamanho~\cite{Henneman1965b} seja obedecido. Mais detalhes podem ser encontrados em~\citeonline{Cisi2008, Elias2012,Watanabe2013} e \citeonline{Elias2014}.

Para cada \ac{PA} que um \ac{MN} gera, a sua \ac{UM} correspondente gera um sinal que é obtido utilizando um filtro de segunda-ordem criticamente amortecido~\cite{Cisi2008} (ver Figura~\ref{fig:poolstruct}(f)). O sinal gerado por uma \ac{UM} em resposta a um \ac{PA} (resposta ao impulso), chamado de abalo, segue a seguinte equação:
\begin{equation}
  a(t)=\frac{t}{\Tp}e^{\left(1-\frac{t}{\Tp}\right)}, t\geqslant0
  \label{eq:twitch}
\end{equation}
em que \Tp é o tempo que o sinal leva para atingir seu valor máximo. Os valores de \Tp variam para cada \ac{UM}, de forma que o princípio do tamanho seja obedecido~\cite{Henneman1965}. Esses sinais de cada \ac{UM} são multiplicados por uma saturação sigmoidal~\cite{Watanabe2013} (ver Figura~\ref{fig:poolstruct}(g)) e então são somados para gerar o sinal de ativação $\act(t)$ de cada músculo (ver Figura~\ref{fig:poolstruct}(c)). A função de saturação de cada \ac{UM} foi ajustada de forma que cada \ac{UM} atingisse sua ativação tetânica quando a frequência de disparos do seu respectivo \ac{MN} atingisse um dado nível, de acordo com os dados de~\citeonline{Enoka2001} e para que o valor da amplitude do sinal gerado em resposta a um \ac{PA} tivesse os mesmos valores encontrados em~\citeonline{Garnett1979, Buchthal1980} e \citeonline{Bellemare1983}. Após a saturação, os sinais obtidos de cada uma das \ac{UM} são somados e normalizados pela força máxima de cada um dos músculos~\cite{Menegaldo2009}. Cada um dos músculos tem um sinal de ativação diferente (ver Figura~\ref{fig:poolstruct}(a,b)). O sinal de ativação de cada músculo é composto de um sinal de ativação para as fibras lentas $\act_I(t)$ e outro para as fibras rápidas $\act_{II}(t)$ (ver seção~\ref{sec:hill}). O sinal $\act_I(t)$ de cada músculo provém das unidades motoras de~\ac{S} e o sinal $\act_{II}(t)$ de cada músculo provém das unidades motoras de~\ac{FR} e \ac{FF}. No caso de simulações com contrações isométricas, não é necessária a utilização de modelo de músculo. Neste caso a força muscular $\F(t)$ é igual ao sinal de ativação $\act(t)$ sem a normalização pela força máxima. Na Tabela~\ref{tab:nummu} está a quantidade de unidades motoras utilizada em cada músculo.

\begin{table}[ht!]
\caption[Número de unidades motoras do modelo]{Número de unidades motoras adotado no modelo para cada músculo do TS e do TA divididos por tipo. S: \acl{S}; FR: \acl{FR}; FF:\acl{FF}}
\label{tab:nummu}
\centering
    \begin{tabular}{lccc}
    \hline
     Núcleo motor& tipo S&tipo FR& tipo FF\\
     \hline
     \acf{SOL}&800&50&50\\
     \acf{GM}&300&150&150\\
     \acf{GL}&130&65&65\\
     \acf{TA}&250&50&50\\
     \hline
    \end{tabular}
\end{table}

\index{modelo!condutância sináptica}
Um elemento particularmente importante para a realização da identificação do modelo é a geração da condutância sináptica, e por esse motivo essa geração será explicada mais detalhadamente a seguir. Os valores dos parâmetros do modelo da condutância sináptica descritos a seguir são para os axônios do comando descendente (condutância sináptica excitatória dendrítica). Os parâmetros das demais sinapses podem ser encontrados em~\citeonline{Elias2013c}.

O decurso temporal da condutância sináptica no compartimento dendrítico é descrito pela seguinte equação diferencial:
\begin{equation}
  \dot{\recneu}(t) = \alpha\neurotr[1-\recneu(t)] - \beta \recneu(t)
  \label{eq:conddif}
\end{equation}
em que $< \dot{ } >$ representa a derivada em relação ao tempo, $\recneu(t)$ representa a fração de receptores ligados a neurotransmissores, $\alpha$ e $\beta$ são as taxas constantes direta e reversa para a ligação de neurotransmissores, respectivamente, e $\neurotr$ é a concentração de neurotransmissor lançado na fenda sináptica.

\citeonline{Destexhe1994} consideram que $\neurotr$ é um pulso, já que essa concentração cresce e decresce muito rapidamente. Com essa suposição, a Eq.~\eqref{eq:conddif} pode ser resolvida de forma analítica. Desta forma, durante o pulso em que $\neurotr=T_{max}$ ($T_{max}=1$ mM), $r(t)$ é dado pela seguinte equação:
\begin{equation}
    r(t-t_0) = r_{\infty}+[r(t_0)-r_{\infty}]e^{\left(-\frac{t-t_0}{\tau_r}\right)}, \, t_0\leqslant t<t_1
    \label{eq:condOn}
\end{equation}
com $r_{\infty}=\frac{\alpha T_{max}}{\alpha T_{max}+\beta}$, a constante de tempo $\tau_r=\frac{1}{\alpha T_{max}+\beta}$, $t_0$ é o instante da ocorrência de um \ac{PA} no axônio correspondente àquela sinapse e $t_1$ é o instante em que o pulso acaba. Foi adotado $\alpha=0,5\text{ ms}^{-1}$ e $\beta=2,5\text{ ms}^{-1}$. Após o pulso, com $\neurotr=0$~mM, $r(t)$ é dado por:
\begin{equation}
  r(t-t_1)=r(t_1)e^{-\beta(t-t_1)}, \,t\geqslant t_1
   \label{eq:condOff}
\end{equation}

A duração do pulso ($t_1-t_0$) foi adotada como 0,2~ms, de forma que a saturação sináptica ocorre para frequências dos processos dos axônios descendentes maiores que 5~kHz. 

A condutância sináptica  $g_{\text{syn}_n}$ da sinapse $n$ é dada pelo produto entre $r_n(t)$ e a máxima condutância sináptica ($\bar{g}_{\text{syn}}=600\text{ nS}$). As sinapses do mesmo tipo (neste caso, excitatórias feitas com os axônios descendentes) podem ser somadas em um único valor de condutância:
\begin{equation}
  g_{\text{syn}}(t)=\sum\limits_{n=1}^M \bar{g}_{\text{syn}}r_{n} = \sum\limits_{n=1}^M g_{\text{syn}_n}
  \label{eq:condgbar}
\end{equation}

O processo de geração da condutância sináptica está esquematizado na Figura~\ref{fig:SynCond}.

\begin{figure}[ht!]
	\center
	\includegraphics[scale=0.7]{SyConductance.eps}
	\caption[Geração da condutância sináptica]{Geração da condutância sináptica. Em cada uma das três colunas à direita é mostrado o processo da geração da condutância $g_{\text{syn}_n}$ de uma sinapse. (a) concentração de neurotransmissor $\neurotr$ lançado na fenda sináptica. Os instantes em que os pulsos de concentração acontecem são os mesmos dos {\it spikes} que chegam do axônio correspondente àquela sinapse (ver Figura~\ref{fig:poolstruct}(c)). À esquerda em destaque um pulso de \neurotr. (b) Fração de receptores ligados a neurotransmissores $r_n(t)$ em cada sinapse. À esquerda em destaque está o decurso temporal de $r_n(t)$ em resposta à um pulso de \neurotr. (c) condutância sináptica $g_{\text{syn}_n}$ de cada sinapse obtida pela multiplicação de $r_n(t)$ por $\bar{g}$. À esquerda em destaque está o decurso temporal de $g_{\text{syn}_n}$ relativo a um pulso de \neurotr. (d) condutância sináptica \cond do MN obtida pela soma de cada uma das $g_{\text{syn}_n}$}
	\label{fig:SynCond}
\end{figure}

No modelo, o cálculo da condutância sináptica $\cond(t)$ é feito utilizando o algoritmo de~\citeonline{Lytton1996}, que calcula  $\cond(t)$ de forma eficiente. Basicamente, este algoritmo se baseia na linearidade e invariância no tempo do modelo cinético aproximado, que descreve a ação sináptica no compartimento dendrítico (Eq.~\eqref{eq:condOn} e Eq.~\eqref{eq:condOff}). Uma única variável é utilizada para representar a superposição das ativações sinápticas que chegam em um determinado \ac{MN}.  Ao invés de tratar cada ativação sináptica de forma individual, o algoritmo usa a informação de um peso de cada sinapse em cada instante para gerar o valor da condutância $\cond(t)$. Mais detalhes podem ser encontrados em~\citeonline{Lytton1996}. 

\index{modelo!comando descendente}
\index{processo estocástico}
Outro elemento do modelo são os axônios que fazem conexões sinápticas com os \acp{MN}, como o comando descendente e os aferentes. Cada um dos $N$ axônios geram os disparos de forma independente dos outros axônios. A geração dos disparos seguem um processo pontual estocástico com uma determinada distribuição, como por exemplo distribuição Poisson ou gama~\cite{Papoulis1991a}. \index{modelo!conectividade}Cada um dos axônios se conecta a uma determinada porcentagem, chamada de conectividade, dos \acp{MN} de forma aleatória. Por exemplo, no caso de um axônio ter conectividade 30\%  e o núcleo de \acp{MN} possuir 100 \acp{MN}, este axônio se conectará a aproximadamente 30 \acp{MN}, escolhidos de forma aleatória. 


\section{Modelo de músculo}
\label{sec:hill}

\index{modelo!músculo}
\index{modelo!Hill}

O modelo de músculo utilizado foi um modelo tipo Hill, similar ao descrito em~\citeonline{Menegaldo2009}, porém acrescido de uma massa, para fins de estabilidade numérica, e de dois elementos contráteis, um representando as fibras lentas ($\C_I$) e outro representando as fibras rápidas ($\C_{II}$)~\cite{Chaud2012a, Watanabe2012e}. O sinal de ativação $\act_I(t)$ \index{ativação, sinal de} é obtido das unidades motoras de fibras de tipo \ac{S}. Da mesma forma, o sinal de ativação $\act_{II}(t)$ é obtido das unidades motoras de fibras de tipo \ac{FR} e \ac{FF} do núcleo de unidades motoras (ver seção~\ref{sec:pool}). A Figura~\ref{fig:hillModel} contém um diagrama do modelo de músculo tipo Hill utilizado para cada um dos três músculos do \ac{TS} e o \ac{TA}, juntamente com os dois proprioceptores já implementados no sistema (ver seção~\ref{sec:proprio}).


\begin{figure}[ht!]
	\center
	\includegraphics[scale=0.7]{hillModel.eps}
	\caption[Modelo de músculo tipo Hill]{Modelo de músculo tipo Hill, juntamente com os proprioceptores (em azul). $\km^{PE}$: parâmetro do elemento elástico passivo em paralelo; $\Ba$: parâmetro do elemento viscoso passivo em paralelo; $\C_{I}$: elemento contrátil das fibras lentas; $\C_{II}$: elemento contrátil das fibras rápidas; \m: massa muscular; $\km^T$: parâmetro do elemento elástico do tendão; \angpen: ângulo de penação; $\Lm^M$: comprimento do músculo; $\Lm^T$: comprimento do tendão; $\Lm^{MT}$: comprimento do sistema músculotendíneo. $\act_I$: sinal de ativação das fibras lentas; $\act_{II}$: sinal de ativação das fibras rápidas; $\freq_{Ia}$: frequência de disparos dos aferentes Ia; $\freq_{II}$: frequência de disparos dos aferentes tipo II; $\freq_{Ib}$: frequência de disparos dos aferentes Ib; MS: \acl{MS}; OTG: \acl{GTO}; $\F^T$: força produzida pelo tendão.}
	\label{fig:hillModel}
\end{figure}

Os elementos $\km^{PE}$ e  \Ba modelam a parte passiva da força ($\F^{PE}$) de cada músculo. Essa força é dada por:
\begin{equation}
    \tilde{\F}^{PE}(t) = \frac{\exp\left[\km^{PE}\left(\frac{\tilde{\Lm}^M(t) - 1}{\strain^M} \right) \right]}{\exp(\km^{PE})} + \Ba \tilde{\vm}(t)
\end{equation}
em que $< \tilde{} >$ representa a grandeza sendo normalizada pelos valores $\F_0$ (força muscular máxima) e $\Lm_0$ (comprimento ótimo) da maneira apropriada (os valores de força são normalizados por $\F_0$, os comprimentos são normalizados por $\Lm_0$ e as combinações desta grandeza são normalizados com combinações de $\F_0$ e $\Lm_0$), e $\strain^M$ é um parâmetro relacionado à diferença entre  $\Lm^M(t)$ e $\Lm_0$ e à magnitude da força produzida pelo elemento elástico passivo em paralelo. 

A força no tendão é dada por:
\begin{equation}
  \tilde{\F}^T(t)=\km^T c^T \ln\left[\exp\left(\frac{\tilde{\Lm}^T(t)-\Lm_r^T}{c^T} + 1 \right) \right] 
\end{equation}

O comprimento do sistema musculotendíneo $\Lm^{MT}(t)$ (sistema composto pelo músculo e o tendão), o comprimento da fibra muscular $\Lm^M(t)$ e o comprimento do tendão $\Lm^{T}(t)$  estão relacionados pela seguinte equação:

\index{sistema musculotendíneo}
\index{modelo!a@ângulo de penação}
\begin{equation}
  \Lm^{MT}(t) = \Lm^T(t)+\Lm^M(t)\cos[\angpen(t))]
\end{equation}
em que $\Lm^{MT}(t)$ é obtido do sistema mecânico (ver seção~\ref{sec:mec}) e $\angpen(t)$ é o ângulo de penação do músculo e é dado por: 
\begin{equation}
 \angpen(t) = \arcsin\left(\frac{\sin(\angpen_0)}{\tilde{\Lm}^M(t)} \right)
\end{equation}
em que $\angpen_0$ é o ângulo de penação inicial.

A força gerada pelos elementos contráteis $\F^C(t)$ é:
\begin{equation}
    \tilde{\F}^C(t) = \act_I(\tempo).\fl_{I}(\tilde{\Lm}^M(t)).\fv_{I}(\tilde{\Lm}^M(t), \tilde{\vm}(t)) + \act_{II}(\tempo).\fl_{II}(\tilde{\Lm}^M(t)).\fv_{II}(\tilde{\Lm}^M(t), \tilde{\vm}(t))
\end{equation}\index{força}
em que fl é a curva força-comprimento e fv é a curva força-velocidade dos elementos contráteis~\cite{Hill1938}. As curvas força-comprimento e força-velocidade são as mesmas utilizadas em~\citeonline{Cheng2000}. \index{modelo!curva força-comprimento}\index{modelo!curva força-velocidade}

Tendo os valores calculados anteriormente, a aceleração da massa \m é calculada usando as leis de Newton. Para obter a velocidade de contração muscular $\vm(t)$ a aceleração da massa \m é integrada uma vez e para obter o comprimento muscular $\Lm^M(t)$ a aceleração da massa \m é integrada duas vezes:
\begin{equation}
  \dot{\tilde{\vm}}(t) = \frac{\F_0}{\m}\left[\tilde{\F}^T(t)\cos\left(\angpen(t) \right) - \left(\tilde{\F}^C(t) + \tilde{\F}^{PE}(t)\cos^2\left(\angpen(t) \right) \right)\right]
\end{equation}

Na Tabela~\ref{tab:hillparam} estão todos os parâmetros adotados para o modelo tipo Hill  ao longo deste trabalho, obtidos em~\citeonline{Cheng2000, Thelen2003, Arnold2010} e \citeonline{DeVlugt2012}.

\begin{table}[h!]
\caption[Parâmetros utilizados no modelo de Hill]{Parâmetros utilizados no modelo de Hill~\cite{Cheng2000, Thelen2003, Arnold2010, DeVlugt2012}}
\label{tab:hillparam}
\centering
  \begin{tabular}{llcccc}
  \hline
      Parâmetro&Unidade&SOL&GM&GL&TA\\
      \hline
      $\F_0$ &N & 3586&1306&606&674\\
      $\Lm_0$ &cm&4,90&5,70&6,40&6,80\\
      \m &kg & 0,53&0,22&0,12&0,15\\
      $\km^{PE}$ &$\F_0/\Lm_0$&5&5&5&5\\
      \Ba&$\F_0.s/\Lm_0$ &0,005&0,005&0,005&0,005\\
      $\strain^M$&-&0,5&0,5&0,5&0,5\\
      $\angpen_0$&graus&28,3&9,9&12&9,6\\
      $\Lm^T_0$&cm&28,9&42,4&41,3&24,9\\
      $\km^T$&$\F_0/\Lm_0^T$&27,8&27,8&27,8&27,8\\
      $c^T$&-&0,005&0,005&0,005&0,005\\
      $\Lm_r^T$&$\Lm_0^T$&0,96&0,96&0,96&0,96\\
      \hline
  \end{tabular}
\end{table}

\section{Modelo de proprioceptores}
\label{sec:proprio}
\index{modelo!proprioceptores}
Aqui serão descritos os dois tipos de proprioceptores implementados no modelo: o \ac{MS} e o \ac{GTO}.  

\index{modelo!fuso muscular}
O modelo de \ac{MS} utilizado é o modelo apresentado por~\citeonline{Mileusnic2006c} e usado em~\citeonline{Chaud2012a}. O  modelo de fuso é colocado em paralelo à fibra muscular (ver Figura~\ref{fig:hillModel}). Ele tem como entrada o comprimento $\Lm^M$ e a variação de comprimento muscular $v$ (obtidos do modelo de músculo tipo Hill) e retorna a frequência de disparo média dos aferentes Ia ($\freq_{I_a}$) e dos aferentes do tipo II ($\freq_{II}$). A $\freq_{I_a}$ é uma combinação do comportamento estático e dinâmico da fibra muscular. Por outro lado, a $\freq_{II}$ tem informação apenas do comportamento estático da fibra. Tendo as frequências $\freq_{I_a}$ e $\freq_{II}$ dos aferentes, são gerados os disparos de cada aferente Ia e II. Esses aferentes disparam com uma frequência média igual a $\freq_{I_a}$ e $\freq_{II}$, respectivamente, com os \acp{ISI} seguindo um processo gama de ordem 25. O valor da ordem dos processos gama dos aferentes Ia e II foi ajustado para que a variabilidade dos disparos dos processos fosse compatível com dados experimentais~\cite{Matthews1969}.
\index{ISI}
\index{modelo!o@órgão tendinoso de Golgi}
\index{processo estocástico!gama}

O modelo de \ac{GTO} é o mesmo reportado por~\citeonline{Lin2002}. A frequência de disparo $\freq_{I_b}$ é dada por:
\begin{align}
  G(t) =& G_1\ln\left(\frac{\F^T(t)}{G_2} + 1 \right)\\
  \frac{\freq_{I_b}(\freqcomp)}{G(\freqcomp)} =& 40\frac{1,70\freqcomp^2+2,58\freqcomp+0,40}{\freqcomp^2+2,20\freqcomp+0,40}  
\end{align}
em que $G_1$ e $G_2$ são constantes iguais a 60~Hz e 4~N, respectivamente e $s$ é a frequência complexa provinda da transformada de Laplace. Tendo a frequência $\freq_{I_b}$ dos aferentes Ib, são gerados os disparos de cada aferente Ib. Esses aferentes disparam com uma frequência média igual a $\freq_{I_b}$, com os \acp{ISI} seguindo um processo gama de ordem 30. O valor da ordem dos processos gama dos aferentes Ib foi ajustado para que a variabilidade dos disparos dos processos fosse compatível com dados experimentais~\cite{Matthews1969}.

Na Tabela~\ref{tab:affnum} estão as quantidades de cada tipo de fibra aferente para cada um dos músculos considerados no modelo.

\begin{table}[h!]
\caption{Quantidade de fibras aferentes para cada músculo}
\label{tab:affnum}
\centering
 \begin{tabular}{lccc}
  \hline
  Músculo&Ia&II&Ib\\
  \hline
  \acf{SOL}&400&500&300\\
  \acf{GM}&160&200&120\\
  \acf{GL}&160&200&120\\
  \acf{TA}&280&350&140\\
  \hline
 \end{tabular}
\end{table}


\section{Modelo mecânico}
\label{sec:mec}


 Neste trabalho é utilizado um modelo mecânico, no qual o sistema neuromuscular pode atuar: um modelo mecânico representando o tornozelo utilizado para o estudo de \ac{TF} e \ac{TP}. O modelo é de segunda-ordem, linear e invariante no tempo e é apresentado a seguir. Após a apresentação do modelo mecânico, é mostrada a obtenção do comprimento musculotendíneo $\Lm^{MT}$ e do momento de cada músculo. 
 
 \subsection{Modelo de tornozelo}
 \label{sec:foot}
 
 \index{modelo!tornozelo}
 \index{tarefa de posição}
 \index{tarefa de força}
 O modelo mecânico que representa o tornozelo pode ser utilizado em duas condições diferentes: \ac{TF}, em que o ângulo do tornozelo não varia, e \ac{TP}, com o ângulo do tornozelo variando. Este modelo  foi utilizado  em ~\citeonline{Watanabe2013a, Watanabe2013b}. Na Figura~\ref{fig:foot} está uma representação deste sistema.

\begin{figure}[ht!]
	\center
	\includegraphics[scale=0.3]{foot.eps}
	\caption[Modelo mecânico do tornozelo]{Modelo mecânico do tornozelo. $W$: momento provindo de uma carga; $\Mom_p$: momento passivo do tornozelo; $\Mom_g$: momento devido à aceleração da gravidade; \Mom: momento ativo exercido pelo tornozelo; $d_f$: distância do centro do pé ao ponto de rotação do tornozelo; $\theta_l$: ângulo que a perna faz com o solo; \angvar: ângulo de variação do tornozelo.}
	\label{fig:foot}
\end{figure}

Durante a \ac{TP}, o ângulo \angvar varia de acordo com:
\begin{equation}
    \ddot{\angvar} = \frac{\Mom - M_g - M_p + W}{\inertia_f}
\end{equation}
em que \Mom é o torque ativo (valores positivos representam dorsoflexão e valores negativos flexão plantar), $\Mom_p$ é o torque passivo (devido à viscoelasticidade dos tecidos), $W$ é o momento provindo de uma carga, $\inertia_f$ é o momento de inércia do pé e $\Mom_g$ é o torque gravitacional. Obtida a aceleração angular $\ddot{\angvar}$, integra-se duas vezes esse valor para obter $\dot{\angvar}$ e \angvar. O torque $\Mom_p$ é obtido por:
\index{torque}
\begin{equation}
 \Mom_p= \Ba_A\dot{\angvar}(t) + \km_A\angvar(t) 
\end{equation}
em que $\Ba_A=1,1\text{ N.m.s/rad}$ e $\km_A = 320\text{ N.m/rad}$ são a viscosidade e a elasticidade passiva do tornozelo, respectivamente (devido à viscoelasticidade dos tecidos). O $\Mom_g$ é obtido por:
\begin{equation}
    \Mom_g=d_fm_f\grav\sin(\theta_l-\angvar)
\end{equation}
com $d_f = 0,052$ m, representando a distância entre o centro do pé e o ponto de rotação do tornozelo, $\grav=9,81 \text{ m/s}^2$ (aceleração da gravidade), $m_f = 2,01$ kg (massa do pé) e $\theta_l = \pi/4$~rad (ângulo da perna com o solo).

%  \subsection{Modelo de pêndulo invertido}
%  \index{modelo!pêndulo invertido}
% \index{controle postural}
%  O modelo de pêndulo invertido está representado na Figura~\ref{fig:invertedPendulum}. Ele foi utilizado em~\citeonline{Elias2013b}.
% 
% \begin{figure}[ht!]
% 	\center
% 	\includegraphics[scale=0.7]{invertedPendulum.eps}
% 	\caption[Modelo mecânico do pêndulo invertido]{Modelo mecânico do pêndulo invertido utilizado para modelar o controle da postura ereta quieta. $h_B$: altura do centro de massa; $\m_b$: massa corporal; $\grav$: aceleração da gravidade; $y_G$: distância do centro de massa em relação ao solo; $\Mom$: momento ativo exercido pelo tornozelo; $y_P$: distância do centro de rotação do tornozelo ao centro de pressão; $F_R$: força de reação aplicada pelo solo no centro de pressão; \angvar: ângulo de variação do pêndulo}
% 	\label{fig:invertedPendulum}
% \end{figure}
% 
% Os valores da massa corporal e altura do centro de massa adotados são: $\m_B= 60\text{ kg}$ e $\h_B=0.85\text{ m}$. O ângulo \angvar varia de acordo com:
% 
% \begin{equation}
% 	  \ddot{\angvar} = \frac{\Mom -\Mom_p + \Mom_g}{\inertia_B}
% \end{equation}
% 
% em que $\inertia_B=(4/3)\m_B\h_B^2$ é o momento de inércia do corpo. Obtida a aceleração angular $\ddot{\angvar}$, integra-se duas vezes esse valor para obter $\dot{\angvar}$ e \angvar. O torque passivo é obtido utilizando:
% 
% \begin{equation}
%  \Mom_p= \Ba_A\dot{\angvar}  + \km_A\angvar
% \end{equation}
% 
% em que $\Ba_A=5,81\text{ N.m.s/rad}$ e $\km_A = 320\text{ N.m/rad}$ são a viscosidade e a elasticidade passiva do tornozelo, respectivamente (devido à viscoelasticidade dos tecidos). O torque gravitacional é computado usando:
% 
% \begin{equation}
%   \Mom_g=\m_B\grav\h_B\sin(\angvar)
%   \end{equation}
  
  \subsection{Cálculo do comprimento do sistema músculotendíneo e do momento}
  
  
O comprimento do músculo-tendão $\Lm^{MT}$ e o braço-de-momento \Rm, utilizados nos dois modelos mecânicos (tornozelo e pêndulo invertido) apresentados acima, são obtidos de equações contidas em \citeonline{Arnold2010}:

\begin{align}
 \Lm^{MT}&=\displaystyle\sum_{k=0}^4\eta_k\angvar^k \label{eq:lmmtco}\\\
 \Rm&=\displaystyle\sum_{k=0}^4\nu_k\angvar^k\label{eq:rmco}
\end{align}

Na Tabela~\ref{tab:lmtdcoef} estão os coeficientes usados para calcular os valores de $\Lm^{MT}$ e \Rm em função de \angvar~\cite{Arnold2010}.

\begin{table}[h!]
\caption[Coeficientes relativos ao cálculo do comprimento do sistema musculotendíneo e braço-de-momento]{Coeficientes relativos ao cálculo do comprimento do sistema musculotendíneo (Eq.~\eqref{eq:lmmtco}) e braço-de-momento (Eq.~\eqref{eq:rmco}). Dados de~\citeonline{Arnold2010}}
\label{tab:lmtdcoef}
\centering
  \begin{tabular}{lcccc}
  \hline
  Parâmetro&SOL&GM&GL&TA\\
  \hline
  $\eta_0$ (cm)&32,3&46,4&45,5&30,6\\
  $\eta_1$ (cm/grau)&$7,22.10^{-2}$&$7,48.10^{-2}$&$7,62.10^{-2}$&$-7,44.10^-2$\\
  $\eta_2$ (cm/grau\textsuperscript{2})&$-2,24.10^{-4}$&$-1,13.10^{-4}$&$-1,25.10^{-4}$&$-1,41.10^{-4}$\\
  $\eta_3$ (cm/grau\textsuperscript{3})&$-3,15.10^{-6}$&$-3,50.10^{-6}$&$-3,55.10^{-6}$&$2,42.10^{-6}$\\
  $\eta_4$ (cm/grau\textsuperscript{4})&$9,27.10^{-9}$&$7,35.10^{-9}$&$7,65.10^{-9}$&$1,50.10^{-8}$\\
  $\nu_0$ (cm)&$-4,1$&-4,3&-4,4&4,3\\
  $\nu_1$ (cm/grau)&$2,57.10^{-2}$&$1,30.10^{-2}$&$1,44.10^{-2}$&$1,66.10^{-2}$\\
  $\nu_2$ (cm/grau\textsuperscript{2})&$5,45.10^{-4}$&$6,08.10^{-4}$&$6,18.10^{-4}$&$-3,89.10^{-4}$\\
  $\nu_3$ (cm/grau\textsuperscript{3})&$-2,22.10^{-6}$&$-1,87.10^{-6}$&$-1,94.10^{-6}$&$-4,45.10^{-6}$\\
  $\nu_4$ (cm/grau\textsuperscript{4})&$-5,50.10^{-9}$&$-1,02.10^{-8}$&$-1,02.10^{-8}$&$-4,34.10^{-8}$\\
  \hline
  \end{tabular}
\end{table}


Tendo o braço-de momento \Rm, o momento \Mom gerado por cada músculo é dado por:
\index{braço-de-momento}
\begin{equation}
 \Mom(\tempo) = \F^T(\tempo).\Rm
 \label{eq:mommus}
\end{equation}

O momento ativo $\Mom(t)$ exercido pelo tornozelo é a soma dos momentos de cada músculo (eq~\eqref{eq:mommus}):
\begin{equation}
  \Mom(t)=\displaystyle\sum_{\substack{k=\text{SOL,GM} \\ \text{GL,TA}}} \Mom_k(t)
\end{equation}

\section{Resolução das equações diferenciais do modelo}

Durante o trabalho apresentado nesta tese, sempre que foi necessário simular o modelo apresentado neste apêndice as suas equações diferenciais  foram resolvidas numericamente utilizando o método de integração de Runge-Kutta de quarta-ordem com passo de integração fixo de 0,05~ms.


\section{Disponibilização do código-fonte do modelo}

\index{código-fonte}
O código-fonte do modelo descrito neste apêndice, escrito na linguagem de programação Java (Oracle\textsuperscript{\textregistered}), está disponível livremente no endereço  \url{http://dx.doi.org/10.6084/m9.figshare.1486375}. 